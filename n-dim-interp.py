import numpy as np
from scipy.interpolate import interp1d

_M = np.array([0.2, 0.4, 0.5, 0.6, 0.8, 1.0, 1.5, 2, 4, 10])
_N = np.array([0.003, 0.006, 0.024])
_Gc = np.array([0.0556, 0.111, 0.222])

L10 = np.array([[#[                          Gc = 0.0556                             ]
                 #[       N<=0.003    ]  [      N<=0.006     ]  [      N<=0.024     ]
                 #  C1   C2   C3   kb      C1   C2   C3   kb      C1   C2   C3   kb  
                 [[ 0.0, 9.0, 0.6,10.0], [ 0.2, 5.0, 0.5,15.0], [ 0.2, 5.0, 0.5,15.0]],
                 [[ 0.0, 8.0, 0.6,10.0], [ 0.2, 5.0, 0.5,15.0], [ 0.2, 5.0, 0.5,15.0]],
                 [[ 0.1, 7.0, 0.6,10.0], [ 0.4, 4.0, 0.5,15.0], [ 0.4, 4.0, 0.5,15.0]],
                 [[ 0.1, 7.0, 0.6,10.0], [ 0.4, 4.0, 0.5,15.0], [ 0.4, 4.0, 0.5,15.0]],
                 [[ 0.1, 7.0, 0.6,10.0], [ 0.7, 3.0, 0.5,15.0], [ 0.7, 3.0, 0.5,15.0]],
                 [[ 0.4, 5.0, 0.6, 5.0], [ 0.7, 3.0, 0.5,15.0], [ 0.7, 3.0, 0.5,15.0]],
                 [[ 0.4, 5.0, 0.6, 5.0], [ 1.1, 2.0, 0.5,15.0], [ 1.1, 2.0, 0.5,15.0]],
                 [[ 0.7, 3.0, 0.6, 5.0], [ 1.6, 0.0, 0.5,15.0], [ 1.6, 0.0, 0.5,15.0]],
                 [[ 1.4, 1.0, 0.6, 5.0], [ 1.9, 0.0, 0.5,15.0], [ 1.9, 0.0, 0.5,15.0]],
                 [[ 1.4, 1.0, 0.6, 5.0], [ 1.9, 0.0, 0.5,15.0], [ 1.9, 0.0, 0.5,15.0]]],
                [#[                          Gc = 0.111                              ]
                 #[       N<=0.003    ]  [      N<=0.006     ]  [      N<=0.024     ]
                 #  C1   C2   C3   kb      C1   C2   C3   kb      C1   C2   C3   kb  
                 [[ 0.1, 9.0, 0.6,10.0], [ 0.1, 7.0, 0.6,10.0], [ 0.1, 7.0, 0.6,10.0]],
                 [[ 0.1, 8.0, 0.6,10.0], [ 0.1, 7.0, 0.6,10.0], [ 0.1, 7.0, 0.6,10.0]],
                 [[ 0.1, 8.0, 0.6,10.0], [ 0.1, 7.0, 0.6,10.0], [ 0.1, 7.0, 0.6,10.0]],
                 [[ 0.2, 8.0, 0.6,10.0], [ 0.2, 6.0, 0.6,10.0], [ 0.2, 6.0, 0.6,10.0]],
                 [[ 0.4, 7.0, 0.6, 5.0], [ 0.3, 6.0, 0.6,10.0], [ 0.3, 6.0, 0.6,10.0]],
                 [[ 0.4, 7.0, 0.6, 5.0], [ 0.4, 6.0, 0.6,10.0], [ 0.4, 6.0, 0.6,10.0]],
                 [[ 0.4, 5.0, 0.6, 5.0], [ 0.8, 4.0, 0.6,10.0], [ 0.8, 4.0, 0.6,10.0]],
                 [[ 0.7, 3.0, 0.6, 5.0], [ 1.5, 0.0, 0.6,10.0], [ 1.5, 0.0, 0.6,10.0]],
                 [[ 1.4, 1.0, 0.6, 5.0], [ 1.5, 0.0, 0.6,10.0], [ 1.5, 0.0, 0.6,10.0]],
                 [[ 1.4, 1.0, 0.6, 5.0], [ 1.5, 0.0, 0.6,10.0], [ 1.5, 0.0, 0.6,10.0]]],
                [#[                          Gc = 0.222                              ]
                 #[       N<=0.003    ]  [      N<=0.006     ]  [      N<=0.024     ]
                 #  C1   C2   C3   kb      C1   C2   C3   kb      C1   C2   C3   kb  
                 [[ 0.1, 8.0, 0.5,15.0], [ 0.1, 8.0, 0.5,10.0], [ 0.1, 8.0, 0.5,10.0]],
                 [[ 0.1, 7.0, 0.5,10.0], [-0.3, 8.0, 0.5,10.0], [-0.3, 8.0, 0.5,10.0]],
                 [[ 0.1, 7.0, 0.5,10.0], [-0.1, 7.0, 0.5,10.0], [-0.1, 7.0, 0.5,10.0]],
                 [[ 0.1, 7.0, 0.5,10.0], [ 0.0, 7.0, 0.5,10.0], [ 0.0, 7.0, 0.5,10.0]],
                 [[ 0.1, 7.0, 0.5, 5.0], [ 0.1, 6.0, 0.5, 5.0], [ 0.1, 6.0, 0.5, 5.0]],
                 [[ 0.1, 7.0, 0.5, 5.0], [ 0.1, 6.0, 0.5, 5.0], [ 0.1, 6.0, 0.5, 5.0]],
                 [[ 0.1, 7.0, 0.5, 5.0], [ 0.5, 3.0, 0.5, 5.0], [ 0.5, 3.0, 0.5, 5.0]],
                 [[ 0.1, 7.0, 0.5, 5.0], [ 0.9, 2.0, 0.5, 5.0], [ 0.9, 2.0, 0.5, 5.0]],
                 [[ 0.1, 7.0, 0.5, 5.0], [ 1.7, 0.0, 0.5, 5.0], [ 1.7, 0.0, 0.5, 5.0]],
                 [[ 0.1, 7.0, 0.5, 5.0], [ 1.7, 0.0, 0.5, 5.0], [ 1.7, 0.0, 0.5, 5.0]]]])


def get_C1_long(Gc, N, M):

    # interpolate C1 on Gc
    _C1_Gc = interp1d(_Gc, L10.T)(Gc)
    # interpolate on N
    print(_C1_Gc.shape)
    print(np.swapaxes(_C1_Gc,1,2).shape)
    _C1_Gc_N = interp1d(_N, np.swapaxes(_C1_Gc,0,1))(N)
    print(_C1_Gc_N)

def get_C1(Gc, N, M):
    return interp1d(_M, interp1d(_N, interp1d(_Gc, L10)(Gc))(N))(M)

#print(get_C1(0.111, 0.006, 0.6))
get_C1_long(0.111, 0.006, 0.6)
