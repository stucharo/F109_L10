import numpy as np
from scipy.interpolate import interp1d, interpn
import time

_M = np.array([0.2, 0.4, 0.5, 0.6, 0.8, 1.0, 1.5, 2, 4, 10])
_N = np.array([0.003, 0.006, 0.024])
_Gc = np.array([0.0556, 0.111, 0.222, 0.556, 1.11, 2.78])

L10 = np.array([
                # C1
                [# M = 0.2
                 [# N = 0.003
                  [0.0, 0.1, 0.1, 1.4, 2.1, 3.4],
                  # N = 0.006
                  [0.2, 0.1, 0.1, 0.0, 1.4, 2.7],
                  # N = 0.024
                  [0.2, 0.1, 0.1, 0.0, 1.4, 2.7]],

                 # M = 0.4
                 [# N = 0.003
                  [0.0, 0.1, 0.1, 0.5, 2.4, 3.4],
                  # N = 0.006
                  [0.2, 0.1, -0.3, 0.3, 1.1, 2.4],
                  # N = 0.024
                  [0.2, 0.1, -0.3, 0.3, 1.1, 2.4]],

                 # M = 0.5
                 [# N = 0.003
                  [0.1, 0.1, 0.1, 0.5, 2.4, 3.0],
                  # N = 0.006
                  [0.4, 0.1, -0.1, 0.3, 1.5, 2.2],
                  # N = 0.024
                  [0.4, 0.1, -0.1, 0.3, 1.5, 2.2]],

                 # M = 0.6
                 [# N = 0.003
                  [0.1, 0.2, 0.1, 0.5, 1.9, 3.2],
                  # N = 0.006
                  [0.4, 0.2, 0.0, 0.3, 1.6, 1.9],
                  # N = 0.024
                  [0.4, 0.2, 0.0, 0.3, 1.6, 1.9]],

                 # M = 0.8
                 [# N = 0.003
                  [0.1, 0.4, 0.1, 1.1, 2.2, 2.4],
                  # N = 0.006
                  [0.7, 0.3, 0.1, 0.4, 1.9, 1.9],
                  # N = 0.024
                  [0.7, 0.3, 0.1, 0.4, 1.9, 1.9]],

                 # M = 1.0
                 [# N = 0.003
                  [0.4, 0.4, 0.1, 1.3, 2.2, 2.3],
                  # N = 0.006
                  [0.7, 0.4, 0.1, 0.4, 2.2, 1.5],
                  # N = 0.024
                  [0.7, 0.4, 0.1, 0.4, 2.2, 1.5]],

                 # M = 1.5
                 [# N = 0.003
                  [0.4, 0.4, 0.1, 1.2, 2.4, 2.3],
                  # N = 0.006
                  [1.1, 0.8, 0.5, 0.8, 2.0, 1.5],
                  # N = 0.024
                  [1.1, 0.8, 0.5, 0.8, 2.0, 1.5]],

                 # M = 2.0
                 [# N = 0.003
                  [0.7, 0.7, 0.1, 1.2, 2.4, 2.3],
                  # N = 0.006
                  [1.6, 1.5, 0.9, 0.8, 2.0, 1.5],
                  # N = 0.024
                  [1.6, 1.5, 0.9, 0.8, 2.0, 1.5]],

                 # M = 4.0
                 [# N = 0.003
                  [1.4, 1.4, 0.1, 1.2, 2.4, 2.3],
                  # N = 0.006
                  [1.9, 1.5, 1.7, 0.8, 2.0, 1.5],
                  # N = 0.024
                  [1.9, 1.5, 1.7, 0.8, 2.0, 1.5]],

                 # M = 10.0
                 [# N = 0.003
                  [1.4, 1.4, 0.1, 1.4, 2.4, 2.3],
                  # N = 0.006
                  [1.9, 1.5, 1.7, 0.8, 2.0, 1.5],
                  # N = 0.024
                  [1.9, 1.5, 1.7, 0.8, 2.0, 1.5]]],

                # C2
                [# M = 0.2
                 [# N = 0.003
                  [9.0, 9.0, 8.0, 3.0, 1.0, 1.0],
                  # N = 0.006
                  [5.0, 7.0, 8.0, 8.0, 4.0, 3.0],
                  # N = 0.024
                  [5.0, 7.0, 8.0, 8.0, 4.0, 3.0]],

                 # M = 0.4
                 [# N = 0.003
                  [8.0, 8.0, 7.0, 6.0, 2.0, 1.0],
                  # N = 0.006
                  [5.0, 7.0, 8.0, 6.0, 7.0, 4.0],
                  # N = 0.024
                  [5.0, 7.0, 8.0, 6.0, 7.0, 4.0]],

                 # M = 0.5
                 [# N = 0.003
                  [7.0, 8.0, 7.0, 6.0, 2.0, 4.0],
                  # N = 0.006
                  [4.0, 7.0, 7.0, 6.0, 5.0, 7.0],
                  # N = 0.024
                  [4.0, 7.0, 7.0, 6.0, 5.0, 7.0]],

                 # M = 0.6
                 [# N = 0.003
                  [7.0, 8.0, 7.0, 6.0, 6.0, 6.0],
                  # N = 0.006
                  [4.0, 6.0, 7.0, 6.0, 5.0, 9.0],
                  # N = 0.024
                  [4.0, 6.0, 7.0, 6.0, 5.0, 9.0]],

                 # M = 0.8
                 [# N = 0.003
                  [7.0, 7.0, 7.0, 4.0, 8.0, 12.0],
                  # N = 0.006
                  [3.0, 6.0, 6.0, 7.0, 6.0, 12.0],
                  # N = 0.024
                  [3.0, 6.0, 6.0, 7.0, 6.0, 12.0]],

                 # M = 1.0
                 [# N = 0.003
                  [5.0, 7.0, 7.0, 4.0, 8.0, 12.0],
                  # N = 0.006
                  [3.0, 6.0, 6.0, 7.0, 6.0, 14.0],
                  # N = 0.024
                  [3.0, 6.0, 6.0, 7.0, 6.0, 14.0]],

                 # M = 1.5
                 [# N = 0.003
                  [5.0, 5.0, 7.0, 7.0, 8.0, 12.0],
                  # N = 0.006
                  [2.0, 4.0, 3.0, 6.0, 8.0, 14.0],
                  # N = 0.024
                  [2.0, 4.0, 3.0, 6.0, 8.0, 14.0]],

                 # M = 2.0
                 [# N = 0.003
                  [3.0, 3.0, 7.0, 7.0, 8.0, 12.0],
                  # N = 0.006
                  [0.0, 0.0, 2.0, 6.0, 8.0, 14.0],
                  # N = 0.024
                  [0.0, 0.0, 2.0, 6.0, 8.0, 14.0]],

                 # M = 4.0
                 [# N = 0.003
                  [1.0, 1.0, 7.0, 7.0, 8.0, 12.0],
                  # N = 0.006
                  [0.0, 0.0, 0.0, 6.0, 8.0, 14.0],
                  # N = 0.024
                  [0.0, 0.0, 0.0, 6.0, 8.0, 14.0]],

                 # M = 10.0
                 [# N = 0.003
                  [1.0, 1.0, 7.0, 6.0, 8.0, 12.0],
                  # N = 0.006
                  [0.0, 0.0, 0.0, 6.0, 8.0, 14.0],
                  # N = 0.024
                  [0.0, 0.0, 0.0, 6.0, 8.0, 14.0]]],

                # C3
                [# M = 0.2
                 [# N = 0.003
                  [0.6, 0.6, 0.5, 0.5, 0.5, 0.5],
                  # N = 0.006
                  [0.5, 0.6, 0.5, 0.5, 0.5, 0.5],
                  # N = 0.024
                  [0.5, 0.6, 0.5, 0.5, 0.5, 0.5]],

                 # M = 0.4
                 [# N = 0.003
                  [0.6, 0.6, 0.5, 0.5, 0.5, 0.5],
                  # N = 0.006
                  [0.5, 0.6, 0.5, 0.5, 0.5, 0.5],
                  # N = 0.024
                  [0.5, 0.6, 0.5, 0.5, 0.5, 0.5]],

                 # M = 0.5
                 [# N = 0.003
                  [0.6, 0.6, 0.5, 0.5, 0.5, 0.5],
                  # N = 0.006
                  [0.5, 0.6, 0.5, 0.5, 0.5, 0.5],
                  # N = 0.024
                  [0.5, 0.6, 0.5, 0.5, 0.5, 0.5]],

                 # M = 0.6
                 [# N = 0.003
                  [0.6, 0.6, 0.5, 0.5, 0.5, 0.5],
                  # N = 0.006
                  [0.5, 0.6, 0.5, 0.5, 0.5, 0.5],
                  # N = 0.024
                  [0.5, 0.6, 0.5, 0.5, 0.5, 0.5]],

                 # M = 0.8
                 [# N = 0.003
                  [0.6, 0.6, 0.5, 0.5, 0.5, 0.5],
                  # N = 0.006
                  [0.5, 0.6, 0.5, 0.5, 0.5, 0.5],
                  # N = 0.024
                  [0.5, 0.6, 0.5, 0.5, 0.5, 0.5]],

                 # M = 1.0
                 [# N = 0.003
                  [0.6, 0.6, 0.5, 0.5, 0.5, 0.5],
                  # N = 0.006
                  [0.5, 0.6, 0.5, 0.5, 0.5, 0.5],
                  # N = 0.024
                  [0.5, 0.6, 0.5, 0.5, 0.5, 0.5]],

                 # M = 1.5
                 [# N = 0.003
                  [0.6, 0.6, 0.5, 0.5, 0.5, 0.5],
                  # N = 0.006
                  [0.5, 0.6, 0.5, 0.5, 0.5, 0.5],
                  # N = 0.024
                  [0.5, 0.6, 0.5, 0.5, 0.5, 0.5]],

                 # M = 2.0
                 [# N = 0.003
                  [0.6, 0.6, 0.5, 0.5, 0.5, 0.5],
                  # N = 0.006
                  [0.5, 0.6, 0.5, 0.5, 0.5, 0.5],
                  # N = 0.024
                  [0.5, 0.6, 0.5, 0.5, 0.5, 0.5]],

                 # M = 4.0
                 [# N = 0.003
                  [0.6, 0.6, 0.5, 0.5, 0.5, 0.5],
                  # N = 0.006
                  [0.5, 0.6, 0.5, 0.5, 0.5, 0.5],
                  # N = 0.024
                  [0.5, 0.6, 0.5, 0.5, 0.5, 0.5]],

                 # M = 10.0
                 [# N = 0.003
                  [0.6, 0.6, 0.5, 0.5, 0.5, 0.5],
                  # N = 0.006
                  [0.5, 0.6, 0.5, 0.5, 0.5, 0.5],
                  # N = 0.024
                  [0.5, 0.6, 0.5, 0.5, 0.5, 0.5]]],

                # Kb
                [# M = 0.2
                 [# N = 0.003
                  [10.0, 10.0, 15.0, 15.0, 15.0, 20.0],
                  # N = 0.006
                  [15.0, 10.0, 10.0, 10.0, 15.0, 20.0],
                  # N = 0.024
                  [15.0, 10.0, 10.0, 10.0, 15.0, 20.0]],

                 # M = 0.4
                 [# N = 0.003
                  [10.0, 10.0, 10.0, 5.0, 15.0, 20.0],
                  # N = 0.006
                  [15.0, 10.0, 10.0, 5.0, 15.0, 20.0],
                  # N = 0.024
                  [15.0, 10.0, 10.0, 5.0, 15.0, 20.0]],

                 # M = 0.5
                 [# N = 0.003
                  [10.0, 10.0, 10.0, 5.0, 15.0, 20.0],
                  # N = 0.006
                  [15.0, 10.0, 10.0, 5.0, 15.0, 20.0],
                  # N = 0.024
                  [15.0, 10.0, 10.0, 5.0, 15.0, 20.0]],

                 # M = 0.6
                 [# N = 0.003
                  [10.0, 10.0, 10.0, 5.0, 15.0, 15.0],
                  # N = 0.006
                  [15.0, 10.0, 10.0, 5.0, 15.0, 15.0],
                  # N = 0.024
                  [15.0, 10.0, 10.0, 5.0, 15.0, 15.0]],

                 # M = 0.8
                 [# N = 0.003
                  [10.0, 5.0, 5.0, 5.0, 15.0, 15.0],
                  # N = 0.006
                  [15.0, 10.0, 5.0, 5.0, 15.0, 15.0],
                  # N = 0.024
                  [15.0, 10.0, 5.0, 5.0, 15.0, 15.0]],

                 # M = 1.0
                 [# N = 0.003
                  [5.0, 5.0, 5.0, 10.0, 15.0, 15.0],
                  # N = 0.006
                  [15.0, 10.0, 5.0, 5.0, 15.0, 15.0],
                  # N = 0.024
                  [15.0, 10.0, 5.0, 5.0, 15.0, 15.0]],

                 # M = 1.5
                 [# N = 0.003
                  [5.0, 5.0, 5.0, 10.0, 15.0, 15.0],
                  # N = 0.006
                  [15.0, 10.0, 5.0, 10.0, 15.0, 15.0],
                  # N = 0.024
                  [15.0, 10.0, 5.0, 10.0, 15.0, 15.0]],

                 # M = 2.0
                 [# N = 0.003
                  [5.0, 5.0, 5.0, 10.0, 15.0, 15.0],
                  # N = 0.006
                  [15.0, 10.0, 5.0, 10.0, 15.0, 15.0],
                  # N = 0.024
                  [15.0, 10.0, 5.0, 10.0, 15.0, 15.0]],

                 # M = 4.0
                 [# N = 0.003
                  [5.0, 5.0, 5.0, 10.0, 15.0, 15.0],
                  # N = 0.006
                  [15.0, 10.0, 5.0, 10.0, 15.0, 15.0],
                  # N = 0.024
                  [15.0, 10.0, 5.0, 10.0, 15.0, 15.0]],

                 # M = 10.0
                 [# N = 0.003
                  [5.0, 5.0, 5.0, 10.0, 15.0, 15.0],
                  # N = 0.006
                  [15.0, 10.0, 5.0, 10.0, 15.0, 15.0],
                  # N = 0.024
                  [15.0, 10.0, 5.0, 10.0, 15.0, 15.0]]]])

L10a = np.swapaxes(np.swapaxes(L10, 0, 3), 1, 2)

def get_L10_interp1d(Gc, N, M):
    return tuple(interp1d(_M, interp1d(_N, interp1d(_Gc, L10)(Gc))(N))(M))

def get_L10_interpn(Gc, N, M):
    return interpn((_Gc, _N, _M), L10a, (Gc, N, M))


v_get_L10_interp1d = np.vectorize(get_L10_interp1d)
pts = [10, 100, 1000, 10000]
funcs = {'interp1d': v_get_L10_interp1d,
         'interpn': get_L10_interpn}

for p in pts:

    Gcs = np.random.uniform(0.0556, 2.78, p)
    Ns = np.random.uniform(0.003, 0.024, p)
    Ms = np.random.uniform(0.2, 10, p)

    for f in funcs.keys():
        s = time.time()
        funcs[f](Gcs, Ns, Ms)
        e = time.time()
        print(f"{f} for {p} pts: {e-s:.5f}s")